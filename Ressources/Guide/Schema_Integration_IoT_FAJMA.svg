<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="blueGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4A90E2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#357ABD;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="greenGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#7ED321;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#5BA517;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="orangeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F5A623;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#D1851A;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="redGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#D0021B;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#B71C1C;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000000" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Titre -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#2C3E50">
    Schéma d'Intégration IoT - Système FAJMA
  </text>
  
  <!-- Zone Patient/Capteurs IoT -->
  <g id="patient-zone">
    <rect x="50" y="80" width="300" height="200" rx="10" fill="#E8F4FD" stroke="#4A90E2" stroke-width="2" filter="url(#shadow)"/>
    <text x="200" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2C3E50">
      Zone Patient - Capteurs IoT
    </text>
    
    <!-- Capteur Cardiaque -->
    <circle cx="120" cy="150" r="25" fill="url(#redGradient)" filter="url(#shadow)"/>
    <text x="120" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white" font-weight="bold">
      ❤️ ECG
    </text>
    <text x="120" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2C3E50">
      Rythme Cardiaque
    </text>
    
    <!-- Capteur Tension -->
    <circle cx="200" cy="150" r="25" fill="url(#blueGradient)" filter="url(#shadow)"/>
    <text x="200" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white" font-weight="bold">
      🩺 BP
    </text>
    <text x="200" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2C3E50">
      Tension Artérielle
    </text>
    
    <!-- Capteur SpO2 -->
    <circle cx="280" cy="150" r="25" fill="url(#orangeGradient)" filter="url(#shadow)"/>
    <text x="280" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white" font-weight="bold">
      🫁 O2
    </text>
    <text x="280" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2C3E50">
      Saturation O2
    </text>
    
    <!-- Smartphone/Gateway -->
    <rect x="150" y="220" width="100" height="40" rx="5" fill="#34495E" filter="url(#shadow)"/>
    <text x="200" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">
      📱 Gateway
    </text>
  </g>
  
  <!-- Protocoles de Communication -->
  <g id="protocols">
    <!-- WiFi -->
    <path d="M 350 140 Q 450 120 550 140" stroke="#7ED321" stroke-width="3" fill="none" marker-end="url(#arrowGreen)"/>
    <text x="450" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#5BA517" font-weight="bold">
      WiFi + HTTPS
    </text>
    
    <!-- 4G/5G -->
    <path d="M 350 180 Q 450 160 550 180" stroke="#F5A623" stroke-width="3" fill="none" marker-end="url(#arrowOrange)"/>
    <text x="450" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#D1851A" font-weight="bold">
      4G/5G + MQTT
    </text>
    
    <!-- LoRaWAN -->
    <path d="M 350 220 Q 450 200 550 220" stroke="#9013FE" stroke-width="3" fill="none" marker-end="url(#arrowPurple)"/>
    <text x="450" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#6A1B9A" font-weight="bold">
      LoRaWAN (Rural)
    </text>
  </g>
  
  <!-- Serveur FAJMA -->
  <g id="server-zone">
    <rect x="550" y="80" width="300" height="400" rx="10" fill="#F8F9FA" stroke="#6C757D" stroke-width="2" filter="url(#shadow)"/>
    <text x="700" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2C3E50">
      Serveur FAJMA - Backend
    </text>
    
    <!-- API Gateway -->
    <rect x="580" y="130" width="240" height="50" rx="5" fill="url(#blueGradient)" filter="url(#shadow)"/>
    <text x="700" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="white" font-weight="bold">
      🚪 API Gateway + Load Balancer
    </text>
    
    <!-- Microservices -->
    <rect x="580" y="200" width="110" height="60" rx="5" fill="url(#greenGradient)" filter="url(#shadow)"/>
    <text x="635" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      📊 IoT Data
    </text>
    <text x="635" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      Collector
    </text>
    <text x="635" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
      Django REST
    </text>
    
    <rect x="710" y="200" width="110" height="60" rx="5" fill="url(#orangeGradient)" filter="url(#shadow)"/>
    <text x="765" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      ⚡ Real-time
    </text>
    <text x="765" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      Processing
    </text>
    <text x="765" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
      WebSocket
    </text>
    
    <rect x="580" y="280" width="110" height="60" rx="5" fill="url(#redGradient)" filter="url(#shadow)"/>
    <text x="635" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      🚨 Alert
    </text>
    <text x="635" y="315" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      Manager
    </text>
    <text x="635" y="330" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
      Notifications
    </text>
    
    <rect x="710" y="280" width="110" height="60" rx="5" fill="#6F42C1" filter="url(#shadow)"/>
    <text x="765" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      🎥 Telemedicine
    </text>
    <text x="765" y="315" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      Gateway
    </text>
    <text x="765" y="330" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
      WebRTC
    </text>
    
    <!-- Base de Données -->
    <rect x="580" y="360" width="240" height="80" rx="5" fill="#495057" filter="url(#shadow)"/>
    <text x="700" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="white" font-weight="bold">
      🗄️ Base de Données PostgreSQL
    </text>
    <text x="620" y="405" font-family="Arial, sans-serif" font-size="10" fill="#ADB5BD">
      • CapteurIoT (statut, type, patient)</text>
    <text x="620" y="420" font-family="Arial, sans-serif" font-size="10" fill="#ADB5BD">
      • SensorData (valeurs temps réel)</text>
    <text x="620" y="435" font-family="Arial, sans-serif" font-size="10" fill="#ADB5BD">
      • IoTAlerts (alertes automatiques)</text>
  </g>
  
  <!-- Interface Médecin -->
  <g id="medecin-zone">
    <rect x="900" y="80" width="250" height="300" rx="10" fill="#E8F5E8" stroke="#28A745" stroke-width="2" filter="url(#shadow)"/>
    <text x="1025" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2C3E50">
      Interface Médecin
    </text>
    
    <!-- Dashboard -->
    <rect x="920" y="130" width="210" height="60" rx="5" fill="#28A745" filter="url(#shadow)"/>
    <text x="1025" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">
      📊 Dashboard Temps Réel
    </text>
    <text x="1025" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
      React + WebSocket
    </text>
    
    <!-- Consultation Vidéo -->
    <rect x="920" y="210" width="210" height="60" rx="5" fill="#17A2B8" filter="url(#shadow)"/>
    <text x="1025" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">
      🎥 Téléconsultation
    </text>
    <text x="1025" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
      WebRTC + IoT Sync
    </text>
    
    <!-- Alertes -->
    <rect x="920" y="290" width="210" height="60" rx="5" fill="#DC3545" filter="url(#shadow)"/>
    <text x="1025" y="315" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">
      🚨 Alertes Critiques
    </text>
    <text x="1025" y="335" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
      Push Notifications
    </text>
  </g>
  
  <!-- Connexions Serveur -> Médecin -->
  <g id="server-to-medecin">
    <path d="M 850 200 L 900 160" stroke="#28A745" stroke-width="3" fill="none" marker-end="url(#arrowGreen)"/>
    <text x="875" y="175" font-family="Arial, sans-serif" font-size="10" fill="#28A745" font-weight="bold">
      WebSocket
    </text>
    
    <path d="M 850 310 L 900 240" stroke="#17A2B8" stroke-width="3" fill="none" marker-end="url(#arrowBlue)"/>
    <text x="875" y="270" font-family="Arial, sans-serif" font-size="10" fill="#17A2B8" font-weight="bold">
      WebRTC
    </text>
    
    <path d="M 850 320 L 900 320" stroke="#DC3545" stroke-width="3" fill="none" marker-end="url(#arrowRed)"/>
    <text x="875" y="315" font-family="Arial, sans-serif" font-size="10" fill="#DC3545" font-weight="bold">
      Push
    </text>
  </g>
  
  <!-- Zone Sécurité -->
  <g id="security-zone">
    <rect x="50" y="500" width="1100" height="120" rx="10" fill="#FFF3CD" stroke="#856404" stroke-width="2" filter="url(#shadow)"/>
    <text x="600" y="525" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#856404">
      🔒 Couche Sécurité
    </text>
    
    <!-- Authentification -->
    <rect x="80" y="540" width="150" height="60" rx="5" fill="#FFC107" filter="url(#shadow)"/>
    <text x="155" y="565" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#212529" font-weight="bold">
      🔐 Authentification
    </text>
    <text x="155" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#212529">
      JWT + X.509 Certs
    </text>
    <text x="155" y="592" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#212529">
      Multi-facteurs
    </text>
    
    <!-- Chiffrement -->
    <rect x="260" y="540" width="150" height="60" rx="5" fill="#28A745" filter="url(#shadow)"/>
    <text x="335" y="565" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      🔐 Chiffrement
    </text>
    <text x="335" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      TLS 1.3 + AES-256
    </text>
    <text x="335" y="592" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      End-to-End
    </text>
    
    <!-- Audit -->
    <rect x="440" y="540" width="150" height="60" rx="5" fill="#6F42C1" filter="url(#shadow)"/>
    <text x="515" y="565" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      📋 Audit Trail
    </text>
    <text x="515" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      Logs sécurisés
    </text>
    <text x="515" y="592" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      Traçabilité RGPD
    </text>
    
    <!-- Monitoring -->
    <rect x="620" y="540" width="150" height="60" rx="5" fill="#DC3545" filter="url(#shadow)"/>
    <text x="695" y="565" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      📊 Monitoring
    </text>
    <text x="695" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      Détection intrusion
    </text>
    <text x="695" y="592" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      Alertes sécurité
    </text>
    
    <!-- Conformité -->
    <rect x="800" y="540" width="150" height="60" rx="5" fill="#17A2B8" filter="url(#shadow)"/>
    <text x="875" y="565" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      ⚖️ Conformité
    </text>
    <text x="875" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      ISO 27799
    </text>
    <text x="875" y="592" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      IEC 62304
    </text>
    
    <!-- Backup -->
    <rect x="980" y="540" width="150" height="60" rx="5" fill="#6C757D" filter="url(#shadow)"/>
    <text x="1055" y="565" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">
      💾 Sauvegarde
    </text>
    <text x="1055" y="580" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      Redondance
    </text>
    <text x="1055" y="592" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      Disaster Recovery
    </text>
  </g>
  
  <!-- Flux de données -->
  <g id="data-flow">
    <text x="50" y="670" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2C3E50">
      Flux de Données Temps Réel :
    </text>
    <text x="50" y="690" font-family="Arial, sans-serif" font-size="12" fill="#495057">
      1. Capteur IoT → Gateway → API (< 100ms)
    </text>
    <text x="50" y="710" font-family="Arial, sans-serif" font-size="12" fill="#495057">
      2. Validation + Stockage → Base de données (< 50ms)
    </text>
    <text x="50" y="730" font-family="Arial, sans-serif" font-size="12" fill="#495057">
      3. Analyse temps réel → Détection alertes (< 200ms)
    </text>
    <text x="50" y="750" font-family="Arial, sans-serif" font-size="12" fill="#495057">
      4. WebSocket → Dashboard médecin (< 150ms)
    </text>
    <text x="50" y="770" font-family="Arial, sans-serif" font-size="12" fill="#495057">
      5. Intégration téléconsultation → Synchronisation A/V + IoT
    </text>
  </g>
  
  <!-- Légende -->
  <g id="legend">
    <rect x="900" y="650" width="250" height="120" rx="5" fill="#F8F9FA" stroke="#DEE2E6" stroke-width="1" filter="url(#shadow)"/>
    <text x="1025" y="670" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2C3E50">
      Légende
    </text>
    
    <circle cx="920" cy="690" r="8" fill="url(#redGradient)"/>
    <text x="940" y="695" font-family="Arial, sans-serif" font-size="11" fill="#495057">
      Capteurs vitaux critiques
    </text>
    
    <circle cx="920" cy="710" r="8" fill="url(#blueGradient)"/>
    <text x="940" y="715" font-family="Arial, sans-serif" font-size="11" fill="#495057">
      Services backend
    </text>
    
    <circle cx="920" cy="730" r="8" fill="url(#greenGradient)"/>
    <text x="940" y="735" font-family="Arial, sans-serif" font-size="11" fill="#495057">
      Interface utilisateur
    </text>
    
    <circle cx="920" cy="750" r="8" fill="#FFC107"/>
    <text x="940" y="755" font-family="Arial, sans-serif" font-size="11" fill="#495057">
      Sécurité et conformité
    </text>
  </g>
  
  <!-- Définition des flèches -->
  <defs>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#7ED321"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#F5A623"/>
    </marker>
    <marker id="arrowPurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#9013FE"/>
    </marker>
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#17A2B8"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#DC3545"/>
    </marker>
  </defs>
</svg>